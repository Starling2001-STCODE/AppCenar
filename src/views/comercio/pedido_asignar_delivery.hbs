<div class="d-flex justify-content-between align-items-center mb-3">
  <button
    class="btn btn-outline-primary d-inline-flex align-items-center"
    type="button"
    data-bs-toggle="offcanvas"
    data-bs-target="#{{sidebarOffcanvasId}}"
    aria-controls="{{sidebarOffcanvasId}}"
  >
    <i class="bi bi-list me-2"></i>
    Menú
  </button>

  <div class="text-end">
    <div class="fw-semibold">{{comercioNombre}}</div>
    <div class="small text-muted">Comercio</div>
  </div>
</div>

<div
  class="offcanvas offcanvas-start"
  tabindex="-1"
  id="{{sidebarOffcanvasId}}"
  aria-labelledby="{{sidebarOffcanvasId}}Label"
>
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="{{sidebarOffcanvasId}}Label">
      {{sidebar.title}}
    </h5>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="offcanvas"
      aria-label="Close"
    ></button>
  </div>
  <div class="offcanvas-body">
    {{> sidebar sidebar}}
  </div>
</div>

<div class="mt-3">
  <div class="row g-4">
    <div class="col-12 col-lg-5">
      <div class="card">
        <div class="card-body">
          <h1 class="h6 mb-2">
            Pedido #{{pedidoId}}
          </h1>
          <p class="text-muted small mb-2">
            {{pedidoFecha}}
          </p>
          <p class="mb-1">
            <span class="text-muted">Cliente:</span><br />
            <strong>{{clienteNombre}}</strong>
          </p>
          <p class="mb-0">
            <span class="text-muted">Estado actual:</span><br />
            <span class="badge bg-secondary">
              {{pedidoEstado}}
            </span>
          </p>
        </div>
      </div>
    </div>

    <div class="col-12 col-lg-7">
      <div class="card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="h6 mb-0">
              Seleccionar delivery
            </h2>
            <a href="/comercio/pedidos/{{pedidoId}}" class="btn btn-link btn-sm">
              ← Volver al pedido
            </a>
          </div>

          {{#if formError}}
            <div class="alert alert-danger">
              {{formError}}
            </div>
          {{/if}}

          {{#if hasDeliveries}}
            <form method="POST" action="/comercio/pedidos/{{pedidoId}}/asignar-delivery">
              <div class="list-group mb-3">
                {{#each deliveries}}
                  <label class="list-group-item d-flex align-items-center gap-3">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="deliveryId"
                      value="{{this.id}}"
                      {{#if ../selectedDeliveryId}}
                        {{#ifEquals ../selectedDeliveryId this.id}}checked{{/ifEquals}}
                      {{/if}}
                    />
                    <div class="d-flex align-items-center gap-2">
                      <div
                        class="rounded-circle bg-light border d-flex align-items-center justify-content-center"
                        style="width: 40px; height: 40px; overflow: hidden;"
                      >
                        {{#if this.avatar}}
                          <img
                            src="{{this.avatar}}"
                            alt="{{this.nombre}}"
                            style="width: 100%; height: 100%; object-fit: cover;"
                          />
                        {{else}}
                          <i class="bi bi-person"></i>
                        {{/if}}
                      </div>
                      <div>
                        <div class="fw-semibold">
                          {{this.nombre}}
                        </div>
                        {{#if this.telefono}}
                          <div class="small">
                            Tel: {{this.telefono}}
                          </div>
                        {{/if}}
                        {{#if this.email}}
                          <div class="small text-muted">
                            {{this.email}}
                          </div>
                        {{/if}}
                      </div>
                    </div>
                  </label>
                {{/each}}
              </div>

              <button type="submit" class="btn btn-primary w-100">
                Asignar delivery
              </button>
            </form>
          {{else}}
            <p class="text-muted mb-0">
              No hay deliveries disponibles en este momento.
            </p>
          {{/if}}
        </div>
      </div>
    </div>
  </div>
</div>
